<VirtualHost 127.0.0.3:80>
  DocumentRoot /var/www
  DirectoryIndex disabled
  DirectoryIndex index.php

  # https://httpd.apache.org/docs/2.4/mod/mod_dir.html#fallbackresource
  # This is the contemporary way to hand requests off to PHP/WP/whatever
  FallbackResource /index.php

  # Disable PHP for uploads and deny any request for a PHP file.
  <Location /wp-content/uploads/>
    DirectoryIndex disabled
    ProxyPass "!"
    RedirectMatch 404 "\.php"
    Options -Indexes
  </Location>

  <Location "/status-apache">
    SetHandler server-status
  </Location>

  #<Files "*.php">
    #SetHandler "proxy:fcgi://fastcgi:9000"
  #</Files>

  #AddHandler "proxy:fcgi://fastcgi:9000" .php

  ProxyPassMatch '^/(?:ping|status)-fpm$' "fcgi://fastcgi:9000"
  ProxyPassMatch '\.php$' "fcgi://fastcgi:9000"
  ProxyPreserveHost On

  # For any file on disk, assume a distant expiry date.
  # The cache requires an Expires/Cache-Control header for files when requested
  # with a query string (like WordPress does for versioned CSS/JS files).
  ExpiresActive On
  ExpiresDefault "modifcation plus 5 minutes"
</VirtualHost>
